<!--
title: Разворот комплекта от клиента на clbs.dev
description: 
published: true
date: 2022-09-09T12:50:02.736Z
tags: 
editor: ckeditor
dateCreated: 2022-08-22T09:21:33.851Z
-->

<h1>Как правильно развернуть комплект</h1>
<h1><strong>Разложить папочки</strong></h1>
<p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Файловую часть</strong> в E:\CLBS_PR\</p>
<p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;WebRmd</strong>&nbsp;в E:\sites\</p>
<p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Базу</strong> в C:\CLBS</p>
<p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Серверную&nbsp;и&nbsp;клиентскую&nbsp;части</strong>&nbsp;в C:\Program Files\IT-Enterprise\</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1><strong>2. В&nbsp;Папке E:\CLBS_PR\MICRON_CLBS\SYSDBF&nbsp; файл Config.IT</strong></h1>
<p>Пример заполнения&nbsp;файла</p>
<p><mark class="marker-yellow"><u>CFG_SQL&nbsp; &nbsp; &nbsp; = DRIVER={SQL Server}; SERVER={DBS\SQL2019}; UID={sa}; PWD={123ewq}; DATABASE={micron}; Network={DBMSSOCN}; APP={IT.%DATABASE%}; WSID={%WSID%}</u></mark></p>
<p><mark class="marker-yellow"><u>CFG_SQLYYY&nbsp; &nbsp;= DRIVER={SQL Server}; SERVER={DBS\SQL2019}; DATABASE={micron_sysdb}; Network={DBMSSOCN}; APP={IT.%DATABASE%}; WSID={%WSID%}</u></mark></p>
<p>CFG_SQLCONT&nbsp; =&nbsp;</p>
<p><mark class="marker-yellow"><u>GL_DW&nbsp; &nbsp; &nbsp; &nbsp; = 019</u></mark></p>
<p>RBKTIMEOUT&nbsp; &nbsp;= 20</p>
<p>WINDOWSAUTH&nbsp; = 1</p>
<p>AUTHMETHODS&nbsp; =&nbsp;</p>
<p>ALLOWSAVEPWD = 1</p>
<p>SHOWLOGINS&nbsp; &nbsp;=&nbsp;</p>
<p><mark class="marker-yellow"><u>CFG_DIRN&nbsp; &nbsp; &nbsp;= E:\CLBS_PR\MICRON_CLBS\TEMP</u></mark></p>
<p><mark class="marker-yellow"><u>CFG_DIRL&nbsp; &nbsp; &nbsp;= E:\CLBS_PR\MICRON_CLBS\TEMP</u></mark></p>
<p><mark class="marker-yellow"><u>CFG_DIRNYYY&nbsp; = E:\CLBS_PR\MICRON_CLBS\TEMP</u></mark></p>
<p><mark class="marker-yellow"><u>CFG_DIRLYYY&nbsp; = E:\CLBS_PR\MICRON_CLBS\TEMP</u></mark></p>
<p>CFG_DIRNCONT =&nbsp;</p>
<p>CFG_DIRLCONT =&nbsp;</p>
<p>ALLOWRECPWD&nbsp; = 0</p>
<p>DEFAULTUSER&nbsp; =&nbsp;</p>
<p>LDAP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp;</p>
<p>DS_EDRPOU&nbsp; &nbsp; =&nbsp;</p>
<p>VFPONDEMAND&nbsp; =</p>
<h1><strong>3. Правим ItNet.Server.exe.Xml&nbsp;в C:\Program Files\IT-Enterprise\MICRON_CLBS\SERVER</strong></h1>
<p>Его&nbsp;пример</p>
<p>&lt;?xml version="1.0" encoding="utf-8"?&gt;</p>
<p>&lt;configuration&gt;</p>
<p>&nbsp; &lt;configSections&gt;</p>
<p>&nbsp; &nbsp; &lt;section name="ITnet" type="IgnoreSection" /&gt;</p>
<p>&nbsp; &lt;/configSections&gt;</p>
<p>&nbsp; &lt;ITnet&gt;</p>
<p>&nbsp; &nbsp; &lt;version base="2022"&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &lt;netClient sp="01.00008" timeStamp="20220123113913" /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &lt;netServer sp="01.00008" timeStamp="20220123113913" /&gt;</p>
<p>&nbsp; &nbsp; &lt;/version&gt;</p>
<p>&nbsp; &nbsp; &lt;Server masterServer="" id="dev"&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &lt;projects&gt;</p>
<p><mark class="marker-yellow">&nbsp; &nbsp; &nbsp; &nbsp; &lt;project key="it_ru" path="E:\CLBS_PR\MICRON_CLBS\ARMW\PRG\" /&gt;</mark></p>
<p>&nbsp; &nbsp; &nbsp; &lt;/projects&gt;</p>
<p><mark class="marker-yellow">&nbsp; &nbsp; &nbsp; &lt;connection protocol="tcp" port="8170" secure="true" encrypt="true" /&gt;</mark></p>
<p>&nbsp; &nbsp; &lt;/Server&gt;</p>
<p>&nbsp; &lt;/ITnet&gt;</p>
<p>&nbsp; &lt;runtime&gt;</p>
<p>&nbsp; &nbsp; &lt;gcConcurrent enabled="false" /&gt;</p>
<p>&nbsp; &nbsp; &lt;generatePublisherEvidence enabled="false" /&gt;</p>
<p>&nbsp; &nbsp; &lt;enforceFIPSPolicy enabled="false" /&gt;</p>
<p>&nbsp; &nbsp; &lt;loadFromRemoteSources enabled="true" /&gt;</p>
<p>&nbsp; &lt;/runtime&gt;</p>
<p>&nbsp; &lt;system.net&gt;</p>
<p>&nbsp; &nbsp; &lt;defaultProxy enabled="true" useDefaultCredentials="true" /&gt;</p>
<p>&nbsp; &lt;/system.net&gt;</p>
<p>&lt;/configuration&gt;</p>
<p>&nbsp;</p>
<p>Для&nbsp;Нас&nbsp;заносим&nbsp;в&nbsp;Файл&nbsp;выбранный&nbsp;порт: C:\CLBS\Порты CLBS.txt</p>
<p>&nbsp;</p>
<h1><strong>4. Правим конфиги Клиента</strong></h1>
<p>C:\Program Files\IT-Enterprise\MICRON_CLBS\CLIENT\ITClient.exe.xml</p>
<p>Пример Файла</p>
<p>&lt;?xml version="1.0" encoding="utf-8"?&gt;</p>
<p>&lt;configuration&gt;</p>
<p>&nbsp; &lt;configSections&gt;</p>
<p>&nbsp; &nbsp; &lt;section name="ITnet" type="IgnoreSection" /&gt;</p>
<p>&nbsp; &lt;/configSections&gt;</p>
<p>&nbsp; &lt;ITnet&gt;</p>
<p>&nbsp; &nbsp; &lt;version base="2022"&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &lt;netClient sp="01.00008" timeStamp="20220123113913" /&gt;</p>
<p>&nbsp; &nbsp; &lt;/version&gt;</p>
<p>&nbsp; &nbsp; &lt;Client&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &lt;connections&gt;</p>
<p><mark class="marker-yellow">&nbsp; &nbsp; &nbsp; &nbsp; &lt;connection uri="DBS:8170 /secure /encrypt" /&gt;</mark></p>
<p>&nbsp; &nbsp; &nbsp; &lt;/connections&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &lt;armParams hostSuffix="" projKey="it_ru" debug="" activation="dllseparated" /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &lt;vfpSettings help="" /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &lt;icons iconset="Clbs" /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &lt;traffic compress="true" /&gt;</p>
<p>&nbsp; &nbsp; &lt;/Client&gt;</p>
<p>&nbsp; &lt;/ITnet&gt;</p>
<p>&nbsp; &lt;runtime&gt;</p>
<p>&nbsp; &nbsp; &lt;generatePublisherEvidence enabled="false" /&gt;</p>
<p>&nbsp; &nbsp; &lt;enforceFIPSPolicy enabled="false" /&gt;</p>
<p>&nbsp; &nbsp; &lt;loadFromRemoteSources enabled="true" /&gt;</p>
<p>&nbsp; &lt;/runtime&gt;</p>
<p>&nbsp; &lt;system.net&gt;</p>
<p>&nbsp; &nbsp; &lt;defaultProxy enabled="true" useDefaultCredentials="true" /&gt;</p>
<p>&nbsp; &lt;/system.net&gt;</p>
<p>&lt;/configuration&gt;</p>
<p>&nbsp;</p>
<h1><strong>5. Подготовить и запустить службу</strong></h1>
<p><strong>В командной строке для создания службы (изменить имя службы, binpath, displayname),&nbsp;CMD&nbsp;запускать от имени администратора:</strong></p>
<p>&nbsp;</p>
<p>obj=user_adm password= a9;i6F!J2z</p>
<p>sc create IT_Server_MICRON type= own start= auto binpath= ""C:\Program Files\IT-Enterprise\MICRON_CLBS\SERVER\ITnet2.Server.Launcher.exe" /service" displayname= "Server IT Ent. - MICRON" depend=EventLog error= severe obj=user_adm password= a9;i6F!J2z</p>
<p><strong><sup>Тут редактор исправляет: кавычки слэш кавычки, и после Launcher.exe тоже слэш</sup></strong></p>
<p>С Нашим паролем иногда возникают проблемы, тогда без него</p>
<p>sc create IT_Server_MICRON type= own start= auto binpath= "\"C:\Program Files\IT-Enterprise\MICRON_CLBS\SERVER\ITnet2.Server.Launcher.exe\" /service" displayname= "IT-Enterprise .NET Application Server Service (MICRON_CLBS)" depend=EventLog error= severe</p>
<p>После чего зайти в службу и проставить от кого она будет работать</p>
<p>&nbsp;</p>
<figure class="image"><img src="/1.png"></figure>
<p><strong>Для&nbsp;изменения&nbsp;параметров&nbsp;перезапуска</strong></p>
<p>SC failure IT_Server_MICRON reset=86400 actions=restart/60000/restart/60000/restart/60000</p>
<p><strong>На случай для удаления</strong></p>
<p>sc delete ИМЯ_СЛУЖБЫ</p>
<p><strong>Ну и корректировки</strong></p>
<p>sc config IT_Server_AEK .... параметры для изменения, как в create</p>
<p><a href="https://dev.azure.com/CLBSDIGITAL/CLBS/_wiki/wikis/CLBS.wiki/51/Создание-службы-ИТЕ">https://dev.azure.com/CLBSDIGITAL/CLBS/_wiki/wikis/CLBS.wiki/51/Создание-службы-ИТЕ</a></p>
<p>&nbsp;</p>
<h1><strong>6. Подменить SessionCore&nbsp;</strong></h1>
<p>Запросить у Литвин или Гриценко нужную версию, посмотреть ее в свойствах файла Itnet2.Server.SessionCore.dll&nbsp;в папке сервера (C:\Program Files\IT-Enterprise\MICRON_CLBS\SERVER)</p>
<figure class="image"><img src="/2.png"></figure>
<p>&nbsp;</p>
<h1><strong>7. Запустить Службу</strong></h1>
<h1><strong>8. Создать пользователя если нету пароля</strong></h1>
<p>В CMD&nbsp;выполнить whoami /user</p>
<p>И Забрать SID</p>
<figure class="image"><img src="/3.png"></figure>
<p>Выбрать любого пользователя (Желательно с MAX&nbsp;правами) и обновить его через SQL</p>
<p>Update TBN2&nbsp;Set</p>
<p>WIN_USER='S-1-5-21-1247624279-2500794307-2618218875-1013'</p>
<p>where USERID='IT_OVSS'</p>
<p>&nbsp;</p>
<h1><strong>9. Изготовить Лицензию. (Делает Гриценко или Литвин)</strong></h1>
<figure class="image"><img src="/4.png"></figure>
<p>&nbsp;</p>
<h1><strong>9. Развернуть WebRMD</strong></h1>
<p>E:\sites\MICRON_RMD</p>
<p>Исправить AppSettings</p>
<p><strong>Пример</strong></p>
<p><strong>&lt;?xml version="1.0" standalone="yes"?&gt;</strong></p>
<p>&lt;appSettings&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <mark class="marker-yellow">&nbsp; &lt;add key="ApplicationServers" value="DBS:8170 /secure /encrypt"/&gt;</mark></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;add key="ApplicationServersId" value=""/&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;add key="ProjectCode" value="it_ru"/&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;add key="Iconset" value="Clbs"/&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <mark class="marker-pink">&nbsp;&nbsp; &lt;add key="AllowWinAuth" value="True"/&gt;</mark> -&nbsp;Удалить&nbsp;Нахер,&nbsp;она&nbsp;рождает&nbsp;неправильный web.config</p>
<p>&lt;/appSettings&gt;</p>
<p>&nbsp;</p>
<h1>Добавить приложение на IIS</h1>
<figure class="image"><img src="/5.png"></figure>
<p><strong>Дополнительно:</strong></p>
<p><strong>Создать пользователей&nbsp;Gritsenko_ и&nbsp;Litvin_a,&nbsp;zabavin_d,lisitsin_a&nbsp;с админскими правами, паролем 123456, и флажком сменить пароль</strong></p>
<p>&nbsp;</p>
<p><strong>Итог:</strong></p>
<p><strong>Выдать ссылку вида&nbsp;</strong><a href="https://dev.clbs.digital/MICRON_RMD/"><strong>https://dev.clbs.digital/MICRON_RMD/</strong></a></p>
<p><strong>Выдать Логины и пароли</strong></p>
<p><strong>На Рабочий Стол пользователей(Windows)&nbsp;Gritsenko_a&nbsp;Litvin_a&nbsp;Кинуть Ярлык на клиента с внятным именованием</strong></p>
<figure class="image"><img src="/6.png"></figure>
