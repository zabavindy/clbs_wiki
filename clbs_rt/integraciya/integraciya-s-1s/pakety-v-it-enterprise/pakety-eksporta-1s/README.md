# Пакеты экспорта 1с

Все документы выгружаются из IT-Ent в 1с

| Код пакета                    | Тип процесса в IT-Enterprise  | Тип процесса в 1с                                                             |
| ----------------------------- | ----------------------------- | ----------------------------------------------------------------------------- |
| COM\_SUP\_N                   | Приход                        | Поступление товаров и услуг                                                   |
| SHIPM\_RTR\_                  | Реализация                    |                                                                               |
| PR\_M333                      | Перемещение                   |                                                                               |
| [SCR](scr.md)                 | Образование фактического лома | Оприходование материалов из производства с видом операции «Возвратные отходы» |
| [APP\_TRANSP](app\_transp.md) | Заявка на транспорт           |                                                                               |
| ...                           |                               |                                                                               |

SQL таблицы:

* EXPDZ – Заголовки пакетов для импорта в 1с
* EXPDS – Строки пакетов для импорта в 1с

&#x20;

Необходимо отбирать по правилу

select EXPDZ.UNEXD from EXPDZ where CONTENT = 'APP\_TRANSP' and RESULT = 0

select

&#x20;              EXPDS.UNEXD

&#x20;              ,EXPDS.ID\_REC

&#x20;              ,EXPDS.DB

&#x20;              ,EXPDS.FL

&#x20;              ,EXPDS.FVAL

&#x20;              ,EXPDS.EXPORDER

from EXPDS

where EXPDS.UNEXD = 843485 – подставляем значения из первого запроса в цикле (необработанные пакеты импорта)

&#x20;

После обработки необходимо пометить пакет как обработанный

// UNEXD - UID пакета

&#x20;              // RESULT - результат обработки пакета

&#x20;                             // 0 - Импорт не выполнялся

&#x20;                             // 1 - Импорт выполнился успешно

&#x20;                             // 2 - Не удалось выполнить импорт

&#x20;                             // 3 - Данные интегрированы

&#x20;                             // 4 - Пакет устарел

&#x20;              // COUNTER - Кол-во попыток

&#x20;              // COMM - Комментарий                       &#x20;

&#x20;

&#x20;              Command.CommandText = "

&#x20;              \| UPDATE EXPDZ

&#x20;              \|             SET RESULT = " + Строка(СтруктураПакета.RESULT) + "

&#x20;              \|                           ,FIO\_O = 'iztt2'

&#x20;              \|                           ,COUNTER = " + Строка(СтруктураПакета.COUNTER + 1) + "

&#x20;              \|                           ,TIMP = '" + Формат(ТекДатаВремя, "ДФ='MM-dd-yyyy HH:mm:ss.000'") + "'

&#x20;              \|                           ,DATE\_K = '" + Формат(ТекДатаВремя, "ДФ='MM-dd-yyyy HH:mm:ss.000'") + "'

&#x20;              \|                            ,COMM = '" + СтрЗаменить(СтруктураПакета.COMM, "'", "") + "'

&#x20;              \|                   &#x20;

&#x20;              \| WHERE UNEXD = " + Формат(СтруктураПакета.UNEXD, "ЧГ=") + "";

&#x20;            &#x20;

&#x20;              Command.Execute();
