---
description: Интерфейс для управления рассылками
---

# Справочник рассылок

{% hint style="info" %}
Инструментальные средства развития → Сервер отчетов → Сервер отчетов → Справочник рассылок
{% endhint %}

![](<../../../.gitbook/assets/0 (38)>)

### Вкладки <a href="#_toc98757965" id="_toc98757965"></a>

Справочник типов рассылки:

* Код – уникальный код рассылки
* Наименование – наименование рассылки
* Примечание – описание рассылки

![](<../../../.gitbook/assets/1 (40)>)

Получатели:

* Тип получателя – Доступные типы Пользователь (USER), Контактное лицо (CONT), Электронная почта (EMAIL).
* Email – электронный адрес получателя, подтягивается изданных в зависимости какой тип пользователя выбран.

От выбранного типа получателя зависит какие поля доступны на редактирования.

Пользователь (USER):

* Пользователь – выбор из справочника пользователей системы:

![](<../../../.gitbook/assets/2 (31)>)

Контактное лицо (CONT)

* Организация – контрагент получателя
* Контактное лицо – контактное лицо контрагента

![](<../../../.gitbook/assets/3 (41)>)

Электронная почта (EMAIL)

* Email – электронный адрес получателя, подтягивается изданных в зависимости какой тип пользователя выбран.

![](<../../../.gitbook/assets/4 (31)>)

### Вызов из Бизнес-логики <a href="#_toc98757966" id="_toc98757966"></a>

Добавить ссылки на пользовательскую сборку MAILING

![](<../../../.gitbook/assets/5 (22)>)

Способ 1

Вызвать метод:

MailingService.Execute(sting mailingTypeCode, sting content, sting subject);

Параметры:

* mailingTypeCode – код типа рассылки
* content - Содержимое письма
* subject - Тема письма
* sendByRobot - Отправка письма роботом. По умолчанию - да.

![](<../../../.gitbook/assets/6 (19)>)

Способ 2

Получить список адресов рассылки

var emails = Recipient.GetRecipientsMail(string mailingTypeCode);

Параметры:

* mailingTypeCode – код типа рассылки
* dopfilter – дополнительный фильтр в формате SqlCmdText (например, выбрать по определенному контрагенту)

Результат список адресов в виде строки(email-ы разделены знаком «,»).

Получившею строку указать в параметры отправки почтового сообщения SendOptions() свойство To:

Далее отправить письмо системным методом MailClient.SendMail().

![](<../../../.gitbook/assets/7 (2)>)

### Мои рассылки <a href="#_toc98757967" id="_toc98757967"></a>

Отображает все рассылки, в которые включен пользователь:

{% hint style="info" %}
Инструменты и настройки → Коммуникации → Мои рассылки
{% endhint %}

![](<../../../.gitbook/assets/8 (8)>)
