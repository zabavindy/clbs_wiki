---
title: Справочник рассылок
description: 
published: true
date: 2022-09-11T17:31:41.313Z
tags: 
editor: markdown
dateCreated: 2022-08-31T09:15:40.634Z
---

# Справочник рассылок

>Инструментальные средства развития → Сервер отчетов → Сервер отчетов → Справочник рассылок

![](<../../assets/0 (38)1.png>)

### Вкладки <a href="#_toc98757965" id="_toc98757965"></a>

Справочник типов рассылки:

* Код – уникальный код рассылки
* Наименование – наименование рассылки
* Примечание – описание рассылки

![](<../../assets/1 (40)1.png>)

Получатели:

* Тип получателя – Доступные типы Пользователь (USER), Контактное лицо (CONT), Электронная почта (EMAIL).
* Email – электронный адрес получателя, подтягивается изданных в зависимости какой тип пользователя выбран.

От выбранного типа получателя зависит какие поля доступны на редактирования.

Пользователь (USER):

* Пользователь – выбор из справочника пользователей системы:

![](<../../assets/2 (31)1.png>)

Контактное лицо (CONT)

* Организация – контрагент получателя
* Контактное лицо – контактное лицо контрагента

![](<../../assets/3 (41)1.png>)

Электронная почта (EMAIL)

* Email – электронный адрес получателя, подтягивается изданных в зависимости какой тип пользователя выбран.

![](<../../assets/4 (31)1.png>)

### Вызов из Бизнес-логики <a href="#_toc98757966" id="_toc98757966"></a>

Добавить ссылки на пользовательскую сборку MAILING

![](<../../assets/5 (22)1.png>)

Способ 1

Вызвать метод:

MailingService.Execute(sting mailingTypeCode, sting content, sting subject);

Параметры:

* mailingTypeCode – код типа рассылки
* content - Содержимое письма
* subject - Тема письма
* sendByRobot - Отправка письма роботом. По умолчанию - да.

![](<../../assets/6 (19)>)

Способ 2

Получить список адресов рассылки

var emails = Recipient.GetRecipientsMail(string mailingTypeCode);

Параметры:

* mailingTypeCode – код типа рассылки
* dopfilter – дополнительный фильтр в формате SqlCmdText (например, выбрать по определенному контрагенту)

Результат список адресов в виде строки(email-ы разделены знаком «,»).

Получившею строку указать в параметры отправки почтового сообщения SendOptions() свойство To:

Далее отправить письмо системным методом MailClient.SendMail().

![](<../../assets/7 (2)1.png>)

### Мои рассылки <a href="#_toc98757967" id="_toc98757967"></a>

Отображает все рассылки, в которые включен пользователь:

>Инструменты и настройки → Коммуникации → Мои рассылки

![](<../../assets/8 (8)1.png>)
